{% extends "pwa_base.html" %}

{% block title %}{{ item.name }} - Printellect Store{% endblock %}

{% block nav_store %}text-white bg-zinc-800{% endblock %}
{% block bnav_store %}active{% endblock %}

{% block header_title %}{{ item.name }}{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto">
  
  <!-- Back Button -->
  <a href="/store" class="inline-flex items-center gap-1.5 text-indigo-400 hover:text-indigo-300 text-sm mb-4 transition">
    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg>
    Back to Store
  </a>
  
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
    <!-- Image -->
    <div>
      <div class="aspect-square bg-zinc-900 border border-zinc-800 rounded-2xl flex items-center justify-center overflow-hidden">
        {% if item.image_data %}
          <img src="data:image/jpeg;base64,{{ item.image_data }}" 
               alt="{{ item.name }}" 
               class="w-full h-full object-cover" />
        {% else %}
          <span class="text-8xl text-zinc-700">üñ®Ô∏è</span>
        {% endif %}
      </div>
      
      {% if item.link_url %}
        <a href="{{ item.link_url }}" target="_blank" 
           class="mt-4 flex items-center justify-center gap-2 text-indigo-400 hover:text-indigo-300 text-sm">
          üîó View Original Model
        </a>
      {% endif %}
    </div>
    
    <!-- Details & Form -->
    <div>
      <h1 class="text-3xl font-bold mb-2">{{ item.name }}</h1>
      
      {% if item.category %}
        <span class="inline-block px-3 py-1 rounded-lg text-sm bg-indigo-600/20 text-indigo-300 mb-4">{{ item.category }}</span>
      {% endif %}
      
      {% if item.description %}
        <p class="text-zinc-300 mb-6">{{ item.description }}</p>
      {% endif %}
      
      <!-- Specs -->
      <div class="bg-zinc-900/60 border border-zinc-800 rounded-xl p-4 mb-6">
        <h3 class="font-semibold mb-3">Specifications</h3>
        <div class="grid grid-cols-2 gap-3 text-sm">
          <div>
            <span class="text-zinc-500">Material</span>
            <p class="font-medium">{{ item.material }}</p>
          </div>
          {% if item.colors %}
            <div>
              <span class="text-zinc-500">Colors</span>
              <p class="font-medium">{{ item.colors }}</p>
            </div>
          {% endif %}
          {% if item.estimated_time_minutes %}
            <div>
              <span class="text-zinc-500">Est. Print Time</span>
              <p class="font-medium">~{{ (item.estimated_time_minutes / 60)|round(1) }} hours</p>
            </div>
          {% endif %}
          {% if files %}
            <div>
              <span class="text-zinc-500">Files Included</span>
              <p class="font-medium">{{ files|length }} file{% if files|length > 1 %}s{% endif %}</p>
            </div>
          {% endif %}
        </div>
      </div>
      
      <!-- Request Form -->
      <div class="bg-gradient-to-br from-indigo-900/30 to-purple-900/20 border border-indigo-500/30 rounded-2xl p-5">
        <h3 class="font-semibold mb-4">Request This Print</h3>
        
        <form method="POST" action="/submit-store-request/{{ item.id }}" class="space-y-4">
          <div class="grid grid-cols-2 gap-4">
            <div>
              <label class="text-sm text-zinc-400">Your Name *</label>
              <input type="text" name="requester_name" required
                     class="w-full mt-1 rounded-xl bg-zinc-950 border border-zinc-800 p-3 text-sm focus:border-indigo-500 focus:outline-none" />
            </div>
            <div>
              <label class="text-sm text-zinc-400">Your Email *</label>
              <input type="email" name="requester_email" required
                     class="w-full mt-1 rounded-xl bg-zinc-950 border border-zinc-800 p-3 text-sm focus:border-indigo-500 focus:outline-none" />
            </div>
          </div>
          
          {% if item.colors %}
            <div>
              <label class="text-sm text-zinc-400">Preferred Color</label>
              <input type="text" name="colors" value="{{ item.colors }}" placeholder="e.g. Black"
                     class="w-full mt-1 rounded-xl bg-zinc-950 border border-zinc-800 p-3 text-sm focus:border-indigo-500 focus:outline-none" />
            </div>
          {% endif %}
          
          <div>
            <label class="text-sm text-zinc-400">Additional Notes (optional)</label>
            <textarea name="notes" rows="3" placeholder="Any special requests or modifications..."
                      class="w-full mt-1 rounded-xl bg-zinc-950 border border-zinc-800 p-3 text-sm resize-none focus:border-indigo-500 focus:outline-none"></textarea>
          </div>
          
          <input type="hidden" name="store_item_id" value="{{ item.id }}" />
          
          <button type="submit" class="w-full rounded-xl bg-indigo-600 hover:bg-indigo-500 transition px-4 py-3 text-sm font-semibold">
            üñ®Ô∏è Submit Request
          </button>
        </form>
        
        <p class="text-xs text-zinc-500 mt-4 text-center">
          You'll receive an email confirmation with a link to track your request
        </p>
      </div>
    </div>
  </div>
</div>
{% endblock %}
